%table
  %thead
    %th User
    %th Starting Balance
    %th Contributions
    %th Reinvestments
    %th Gross Gains
    %th Management Fee
    %th Ending Balance
  %tbody
    - @growths.each do |growth|
      %tr
        %th= growth.user
        %td= number_to_currency growth.starting_value
        %td= number_to_currency growth.contributions.sum(&:amount)
        %td= number_to_currency growth.reinvestments.sum(&:amount)
        %td= number_to_currency growth.gross_gains
        - if growth.closed?
          %td= number_to_currency -growth.booked_fee
          %th= number_to_currency growth.value
        - else
          %td.tentative= number_to_currency -growth.unbooked_fee
          %th.tentative= number_to_currency growth.value
  %tfoot
    %tr
      %th
      %th= number_to_currency @growths.sum(&:starting_value)
      %th= number_to_currency @growths.map(&:contributions).flatten.sum(&:amount)
      %th= number_to_currency @growths.map(&:reinvestments).flatten.sum(&:amount)
      %th= number_to_currency @growths.sum(&:gross_gains)
      - if @growths.all?(&:closed?)
        %td= number_to_currency -@growths.sum(&:booked_fee)
        %th= number_to_currency @growths.sum(&:value)
      - else
        %th.tentative= number_to_currency -@growths.sum(&:unbooked_fee)
        %th.tentative= number_to_currency @growths.sum(&:value)
